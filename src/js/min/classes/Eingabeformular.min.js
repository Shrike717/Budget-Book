import Fehlerbox from"./Fehlerbox.min.js";import liqui_planner from"./../liqui-planner.min.js";export default class Eingabeformular{constructor(){this._html=this._html_generieren()}_formulardaten_holen(a){return{titel:a.target.elements.titel.value,betrag:a.target.elements.betrag.value,einnahme:a.target.elements.einnahme.checked,datum:a.target.elements.datum.valueAsDate}}_formulardaten_verarbeiten(a){return{titel:a.titel.trim(),typ:!1===a.einnahme?"ausgabe":"einnahme",betrag:100*parseFloat(a.betrag),datum:a.datum}}_formulardaten_validieren(a){let b=[];return""===a.titel&&b.push("Titel:"),isNaN(a.betrag)&&b.push("Betrag:"),null===a.datum&&b.push("Datum:"),b}_datum_aktualisieren(){let a=document.querySelector("#datum");null!==a&&(a.valueAsDate=new Date)}_absenden_event_hinzufuegen(a){a.querySelector("#eingabeformular").addEventListener("submit",a=>{a.preventDefault();let b=this._formulardaten_verarbeiten(this._formulardaten_holen(a)),c=this._formulardaten_validieren(b);if(0===c.length){liqui_planner.eintrag_hinzufuegen(b);let c=document.querySelector(".fehlerbox");null!==c&&c.remove(),a.target.reset(),this._datum_aktualisieren()}else{let a=new Fehlerbox("Es gibt Fehler in folgenden Eingabefeldern:",c);a.anzeigen()}})}_html_generieren(){let a=document.createElement("section");return a.setAttribute("id","eingabeformular-container"),a.innerHTML=`<form id="eingabeformular" action="#" method="get"></form>
            <div class="eingabeformular-zeile">
                <h1>Neue Einnahme / Ausgabe hinzufügen</h1>
            </div>
            <div class="eingabeformular-zeile">
                <div class="titel-typ-eingabe-gruppe">
                    <label for="titel">Titel</label>
                    <input type="text" id="titel" form="eingabeformular" name="titel" placeholder="z.B. Einkaufen" size="10" title="Titel des Eintrags" required>
                    <input type="radio" id="einnahme" name="typ" value="einnahme" form="eingabeformular" title="Typ des Eintrags">
                    <label for="einnahme" title="Typ des Eintrags">Einnahme</label>
                    <input type="radio" id="ausgabe" name="typ" value="ausgabe" form="eingabeformular" title="Typ des Eintrags" checked>
                    <label for="ausgabe" title="Typ des Eintrags">Ausgabe</label>
                </div>
            </div>
            <div class="eingabeformular-zeile">
                <div class="betrag-datum-eingabe-gruppe">
                    <label for="betrag">Betrag</label>
                    <input type="number" id="betrag" name="betrag" form="eingabeformular" placeholder="z.B. 10,42" size="10" step="0.01" min="0.01" title="Betrag des Eintrags (max. zwei Nachkommastellen, kein €-Zeichen)" required>
                    <label for="datum">Datum</label>
                    <input type="date" id="datum" name="datum" form="eingabeformular" title="Datum des Eintrags" required>
                </div>
            </div>
            <div class="eingabeformular-zeile">
                <button class="standard" type="submit" form="eingabeformular">Hinzufügen</button>
            </div>`,this._absenden_event_hinzufuegen(a),a}anzeigen(){let a=document.querySelector("#navigationsleiste");null!==a&&(a.insertAdjacentElement("afterend",this._html),this._datum_aktualisieren())}}
